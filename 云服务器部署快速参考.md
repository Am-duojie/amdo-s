# äº‘æœåŠ¡å™¨éƒ¨ç½²å¿«é€Ÿå‚è€ƒ

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²æ¸…å•

### ç¬¬ä¸€æ­¥ï¼šæœåŠ¡å™¨å‡†å¤‡
- [ ] è´­ä¹°äº‘æœåŠ¡å™¨ï¼ˆæ¨èï¼š2æ ¸4GBï¼ŒUbuntu 22.04ï¼‰
- [ ] é…ç½®å®‰å…¨ç»„ï¼ˆå¼€æ”¾ 22, 80, 443 ç«¯å£ï¼‰
- [ ] SSH è¿æ¥åˆ°æœåŠ¡å™¨

### ç¬¬äºŒæ­¥ï¼šå®‰è£…ç¯å¢ƒ
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…åŸºç¡€å·¥å…·
sudo apt install -y curl wget git vim ufw

# å®‰è£… Pythonã€Node.jsã€MySQLã€Redisã€Nginx
# ï¼ˆè¯¦è§å®Œæ•´æŒ‡å—ï¼‰
```

### ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²é¡¹ç›®
```bash
# 1. å…‹éš†æˆ–ä¸Šä¼ ä»£ç åˆ° /var/www/secondhand
cd /var/www/secondhand

# 2. é…ç½®åç«¯
cd backend
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 3. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆåˆ›å»º .env æ–‡ä»¶ï¼‰
# 4. æ‰§è¡Œæ•°æ®åº“è¿ç§»
# 5. æ”¶é›†é™æ€æ–‡ä»¶

# 6. æ„å»ºå‰ç«¯
cd ../frontend
npm install
npm run build
```

### ç¬¬å››æ­¥ï¼šé…ç½®æœåŠ¡
```bash
# é…ç½® systemd æœåŠ¡
sudo cp deploy/systemd/secondhand-backend.service.example /etc/systemd/system/secondhand-backend.service
sudo systemctl enable secondhand-backend
sudo systemctl start secondhand-backend

# é…ç½® Nginx
sudo cp deploy/nginx.conf.example /etc/nginx/sites-available/secondhand
sudo ln -s /etc/nginx/sites-available/secondhand /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

### ç¬¬äº”æ­¥ï¼šé…ç½® SSLï¼ˆå¯é€‰ï¼‰
```bash
sudo certbot --nginx -d ä½ çš„åŸŸå.com
```

---

## ğŸ“‹ å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†
```bash
# åç«¯æœåŠ¡
sudo systemctl start secondhand-backend
sudo systemctl stop secondhand-backend
sudo systemctl restart secondhand-backend
sudo systemctl status secondhand-backend
sudo journalctl -u secondhand-backend -f

# Nginx
sudo systemctl restart nginx
sudo nginx -t

# MySQL
sudo systemctl status mysql

# Redis
sudo systemctl status redis-server
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# Django æ—¥å¿—
tail -f /var/www/secondhand/backend/logs/django.log

# Nginx æ—¥å¿—
tail -f /var/log/nginx/secondhand_error.log

# ç³»ç»Ÿæ—¥å¿—
sudo journalctl -xe
```

### å¤‡ä»½
```bash
# æ‰‹åŠ¨å¤‡ä»½
bash deploy/scripts/backup.sh

# è®¾ç½®è‡ªåŠ¨å¤‡ä»½ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹ï¼‰
crontab -e
# æ·»åŠ : 0 2 * * * /var/www/secondhand/deploy/scripts/backup.sh
```

---

## âš™ï¸ å…³é”®é…ç½®æ–‡ä»¶

### åç«¯ç¯å¢ƒå˜é‡ (.env)
```env
DJANGO_SETTINGS_MODULE=core.settings_production
SECRET_KEY=ä½ çš„å¯†é’¥
DB_NAME=secondhand_platform
DB_USER=dbuser
DB_PASSWORD=æ•°æ®åº“å¯†ç 
```

### å‰ç«¯ç¯å¢ƒå˜é‡ (.env.production)
```env
VITE_API_URL=https://ä½ çš„åŸŸå/api
```

### Nginx é…ç½®ä½ç½®
```
/etc/nginx/sites-available/secondhand
/etc/nginx/sites-enabled/secondhand (ç¬¦å·é“¾æ¥)
```

### Systemd æœåŠ¡é…ç½®
```
/etc/systemd/system/secondhand-backend.service
```

---

## ğŸ” é—®é¢˜æ’æŸ¥

| é—®é¢˜ | æ£€æŸ¥å‘½ä»¤ |
|------|---------|
| 502 Bad Gateway | `sudo systemctl status secondhand-backend` |
| é™æ€æ–‡ä»¶404 | `python manage.py collectstatic --noinput` |
| æ•°æ®åº“è¿æ¥å¤±è´¥ | `mysql -u dbuser -p` |
| WebSocketå¤±è´¥ | æ£€æŸ¥ Nginx é…ç½®ä¸­çš„ `/ws` location |

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- **å®Œæ•´æŒ‡å—**ï¼š`äº‘æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—.md`
- **é…ç½®æ–‡ä»¶**ï¼š`deploy/` ç›®å½•
- **éƒ¨ç½²è„šæœ¬**ï¼š`deploy/scripts/` ç›®å½•

---

## ğŸ’¡ æç¤º

1. **é¦–æ¬¡éƒ¨ç½²**ï¼šå»ºè®®ä½¿ç”¨å®Œæ•´æŒ‡å—é€æ­¥æ“ä½œ
2. **æ›´æ–°ä»£ç **ï¼šä½¿ç”¨ `deploy/scripts/deploy.sh` è„šæœ¬
3. **å®šæœŸå¤‡ä»½**ï¼šé…ç½®è‡ªåŠ¨å¤‡ä»½ä»»åŠ¡
4. **ç›‘æ§èµ„æº**ï¼šä½¿ç”¨ `htop` æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ

---

*å¿«é€Ÿå‚è€ƒ - è¯¦ç»†æ­¥éª¤è¯·æŸ¥çœ‹å®Œæ•´æŒ‡å—*




