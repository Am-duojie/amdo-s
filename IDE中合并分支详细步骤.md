# 在 IDE 中合并分支 - 详细步骤

## 🎯 前提条件

在合并分支之前，确保：

1. ✅ 实验分支的代码已经提交
2. ✅ 你已经完成了实验，决定合并
3. ✅ 当前在 main 分支上（或目标分支）

---

## 📋 方法1：使用命令面板（推荐）

### 完整步骤

#### 第1步：切换到主分支

```
1. 点击底部状态栏的分支名（显示当前分支）
2. 选择 "main" 分支
3. ✅ 已切换到 main 分支
```

**或者**：
```
1. 按 Ctrl+Shift+P 打开命令面板
2. 输入：Git: Checkout to...
3. 选择：main
4. ✅ 已切换到 main 分支
```

#### 第2步：确保主分支是最新的

```
1. 点击底部状态栏的"同步更改"图标（两个箭头）
   或者
2. 按 Ctrl+Shift+P
3. 输入：Git: Pull
4. 按 Enter
✅ 主分支已更新到最新
```

#### 第3步：合并实验分支

```
1. 按 Ctrl+Shift+P 打开命令面板
2. 输入：Git: Merge Branch...
3. 按 Enter
4. 选择要合并的分支：experiment/ai-recommendation
5. 按 Enter
✅ 合并完成！
```

#### 第4步：推送合并后的代码

```
1. 点击底部状态栏的"同步更改"图标
   或者
2. 按 Ctrl+Shift+P → Git: Push
✅ 代码已推送到 GitHub
```

---

## 📋 方法2：使用源代码管理面板

### 步骤

#### 第1步：打开源代码管理面板

```
1. 点击左侧边栏的 Git 图标（或按 Ctrl+Shift+G）
2. ✅ 打开源代码管理面板
```

#### 第2步：切换到主分支

```
1. 在源代码管理面板顶部，点击当前分支名
2. 选择 "main" 分支
3. ✅ 已切换到 main 分支
```

#### 第3步：使用菜单合并

```
1. 在源代码管理面板顶部，点击 "..." 菜单
2. 选择 "分支" → "合并分支..."
3. 选择要合并的分支：experiment/ai-recommendation
4. 按 Enter
✅ 合并完成！
```

---

## 🎨 完整操作流程示例

### 场景：合并"AI推荐"实验分支

#### 步骤1：确认实验分支已提交

```
1. 切换到实验分支
   点击底部状态栏 → 选择 experiment/ai-recommendation

2. 检查是否有未提交的修改
   在"更改"区域查看
   如果有未提交的修改，先提交：
   - 点击文件旁的 "+" 暂存
   - 输入提交信息
   - 点击"提交"按钮
```

#### 步骤2：切换到主分支

```
方法A（推荐）：
1. 点击底部状态栏的分支名
2. 选择 "main"
✅ 已切换到 main 分支

方法B：
1. 按 Ctrl+Shift+P
2. 输入：Git: Checkout to...
3. 选择：main
✅ 已切换到 main 分支
```

#### 步骤3：更新主分支（重要！）

```
1. 点击底部状态栏的"同步更改"图标（两个箭头）
   或者
2. 按 Ctrl+Shift+P → Git: Pull
✅ 确保主分支是最新的
```

#### 步骤4：合并实验分支

```
1. 按 Ctrl+Shift+P 打开命令面板
2. 输入：Git: Merge Branch...
3. 按 Enter
4. 在列表中选择：experiment/ai-recommendation
5. 按 Enter

✅ 合并完成！
```

#### 步骤5：处理可能的冲突（如果有）

如果合并时出现冲突：

```
1. IDE 会提示有冲突
2. 在"更改"区域会显示冲突文件
3. 点击冲突文件，查看冲突内容
4. 手动解决冲突：
   - 选择保留哪些代码
   - 删除冲突标记（<<<<<<< ======= >>>>>>>）
5. 解决后：
   - 点击文件旁的 "+" 暂存
   - 输入提交信息："解决合并冲突"
   - 点击"提交"按钮
```

#### 步骤6：推送合并后的代码

```
1. 点击底部状态栏的"同步更改"图标
   或者
2. 按 Ctrl+Shift+P → Git: Push
✅ 合并后的代码已推送到 GitHub
```

#### 步骤7：删除实验分支（可选）

```
1. 按 Ctrl+Shift+P
2. 输入：Git: Delete Branch...
3. 选择：experiment/ai-recommendation
4. 按 Enter
✅ 实验分支已删除（本地）

如果要删除远程分支：
1. 按 Ctrl+Shift+P
2. 输入：Git: Delete Remote Branch...
3. 选择：origin/experiment/ai-recommendation
✅ 远程分支已删除
```

---

## 🔍 可视化操作流程

### 在 IDE 中的操作

```
┌─────────────────────────────────────┐
│ 1. 点击底部状态栏                   │
│    [main] ← 点击这里                │
│    ↓                                │
│    选择 "main"                      │
└─────────────────────────────────────┘
           ↓
┌─────────────────────────────────────┐
│ 2. 更新主分支                        │
│    点击"同步更改"图标（两个箭头）     │
└─────────────────────────────────────┘
           ↓
┌─────────────────────────────────────┐
│ 3. 打开命令面板                      │
│    按 Ctrl+Shift+P                   │
│    ↓                                │
│    输入：Git: Merge Branch...        │
│    ↓                                │
│    选择：experiment/ai-recommendation│
└─────────────────────────────────────┘
           ↓
┌─────────────────────────────────────┐
│ 4. 合并完成！                        │
│    ✅ 实验分支的代码已合并到 main    │
└─────────────────────────────────────┘
           ↓
┌─────────────────────────────────────┐
│ 5. 推送代码                          │
│    点击"同步更改"图标                 │
│    ✅ 代码已推送到 GitHub            │
└─────────────────────────────────────┘
```

---

## ⚠️ 处理合并冲突

### 如果出现冲突

合并时如果两个分支修改了同一个文件的同一部分，会出现冲突：

#### 识别冲突

```
在"更改"区域会显示：
⚠️ 冲突文件（红色标记）
```

#### 解决冲突

```
1. 点击冲突文件
2. IDE 会显示冲突内容：
   
   <<<<<<< HEAD
   主分支的代码
   =======
   实验分支的代码
   >>>>>>> experiment/ai-recommendation

3. 手动选择：
   - 保留主分支的代码
   - 保留实验分支的代码
   - 或者合并两者

4. 删除冲突标记（<<<<<<< ======= >>>>>>>）

5. 保存文件

6. 暂存并提交：
   - 点击文件旁的 "+"
   - 输入："解决合并冲突"
   - 点击"提交"按钮
```

---

## 🎯 快速操作参考

### 合并分支的完整命令

| 步骤 | 操作 | 快捷键/方法 |
|------|------|------------|
| 1. 切换分支 | 点击底部状态栏分支名 → 选择 main | 或 `Ctrl+Shift+P` → `Git: Checkout to...` |
| 2. 更新主分支 | 点击"同步更改"图标 | 或 `Ctrl+Shift+P` → `Git: Pull` |
| 3. 合并分支 | `Ctrl+Shift+P` → `Git: Merge Branch...` | 选择要合并的分支 |
| 4. 推送代码 | 点击"同步更改"图标 | 或 `Ctrl+Shift+P` → `Git: Push` |
| 5. 删除分支 | `Ctrl+Shift+P` → `Git: Delete Branch...` | 选择要删除的分支 |

---

## 💡 实用技巧

### 技巧1：查看要合并的分支

在合并前，可以先查看实验分支的提交：

```
1. 切换到实验分支
2. 在"图形"区域查看提交历史
3. 确认要合并的提交
4. 切换回 main 分支
5. 执行合并
```

### 技巧2：使用图形视图查看合并

```
1. 合并后，在"图形"区域查看
2. 可以看到合并提交
3. 可以看到分支的合并点
```

### 技巧3：撤销合并（如果出错）

如果合并出错，可以撤销：

```
1. 按 Ctrl+Shift+P
2. 输入：Git: Undo Last Commit
3. 或者查看提交历史，回退到合并前的提交
```

---

## 🎁 实际例子

### 例子：合并"微信支付"实验分支

```
1. 确认实验分支已提交
   - 切换到 experiment/wechat-pay
   - 检查是否有未提交的修改
   - 如果有，先提交

2. 切换到主分支
   - 点击底部状态栏 → 选择 main

3. 更新主分支
   - 点击"同步更改"图标

4. 合并实验分支
   - Ctrl+Shift+P
   - 输入：Git: Merge Branch...
   - 选择：experiment/wechat-pay
   - 按 Enter

5. 如果有冲突，解决冲突
   - 点击冲突文件
   - 手动解决
   - 暂存并提交

6. 推送代码
   - 点击"同步更改"图标

7. 删除实验分支（可选）
   - Ctrl+Shift+P
   - 输入：Git: Delete Branch...
   - 选择：experiment/wechat-pay

✅ 完成！
```

---

## ⚠️ 注意事项

### 1. 合并前确保主分支是最新的

```
✅ 正确：
1. 切换到 main
2. 点击"同步更改"（拉取最新代码）
3. 然后合并

❌ 错误：
1. 直接合并
2. 可能覆盖其他人的提交
```

### 2. 合并前确保实验分支已提交

```
✅ 正确：
1. 在实验分支上提交所有修改
2. 然后切换回 main 合并

❌ 错误：
1. 有未提交的修改就切换分支
2. 可能导致修改丢失
```

### 3. 合并后记得推送

```
✅ 正确：
1. 合并后立即推送
2. 确保远程仓库也更新了

❌ 错误：
1. 只合并不推送
2. 远程仓库还是旧的
```

---

## 🎯 总结

### 在 IDE 中合并分支的步骤

```
1. 切换到主分支（main）
2. 更新主分支（拉取最新代码）
3. 合并实验分支（Ctrl+Shift+P → Git: Merge Branch...）
4. 处理冲突（如果有）
5. 推送代码（同步更改）
6. 删除实验分支（可选）
```

### 关键命令

- **合并分支**：`Ctrl+Shift+P` → `Git: Merge Branch...`
- **切换分支**：点击底部状态栏分支名
- **推送代码**：点击"同步更改"图标

**所有操作都可以通过图形界面完成！** 🎉

